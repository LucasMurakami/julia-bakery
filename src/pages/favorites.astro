---
import Layout from '@/layouts/Layout.astro';
import Nav from '@/components/ui/Nav';
import Footer from '@/components/Footer.astro';
import { allProducts } from '@/lib/products';
import { Card, CardContent, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';

const favorites = allProducts.filter(p => p.bestseller);

// Fallback in case no favorites are marked
if (favorites.length === 0) {
    favorites.push(...allProducts.slice(0, 4));
}
---

<Layout title="Nossos Favoritos | Pinckmax">
  <div class="min-h-screen bg-[hsl(var(--background))]">
    <Nav client:load forceOpaque={true} />
    
    <main class="py-24 px-6 md:px-10 lg:px-16">
       <div class="mx-auto max-w-7xl">
         <div class="text-center mb-16">
            <h1 class="text-4xl font-bold uppercase tracking-wide text-[hsl(var(--foreground))] sm:text-5xl md:text-6xl">Favoritos da Casa</h1>
            <div class="mt-4 h-1 w-24 bg-[hsl(var(--primary))] mx-auto rounded-full"></div>
            <p class="mt-6 text-lg leading-8 text-[hsl(var(--muted-foreground))] max-w-2xl mx-auto">
              Uma seleção especial dos itens mais amados pelos nossos clientes e recomendados pelos nossos chefs.
            </p>
         </div>

         <div class="grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 xl:gap-x-8">
            {favorites.map((product) => (
             <Card className="group relative flex flex-col overflow-hidden border-none shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-1 bg-card">
              <a href={`/${product.category.name}/${product.slug || product.id}`} class="absolute inset-0 z-20">
                 <span class="sr-only">Ver detalhes de {product.name}</span>
              </a>
              
              <div class="relative w-full aspect-square overflow-hidden bg-[hsl(var(--muted))]">
                <img
                  src={product.image}
                  alt={product.name}
                  class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                  loading="lazy"
                />
                 <div class="absolute inset-0 bg-black/0 transition-colors group-hover:bg-black/5"></div>
                 <div class="absolute top-2 right-2 z-10">
                    <span class="inline-flex items-center rounded-full bg-[hsl(var(--primary))] px-2.5 py-0.5 text-xs font-semibold text-[hsl(var(--primary-foreground))] shadow-md">
                        Favorito
                    </span>
                 </div>
              </div>
              
              <CardHeader className="text-center pt-6 pb-2">
                <CardTitle className="text-lg font-bold uppercase leading-6 text-[hsl(var(--foreground))] group-hover:text-[hsl(var(--primary))] transition-colors">
                    {product.name}
                </CardTitle>
              </CardHeader>
    
              <CardContent className="text-center pb-2 flex-grow">
                 <p class="line-clamp-2 text-sm text-[hsl(var(--muted-foreground))]">{product.product_description}</p>
              </CardContent>
                
              <CardFooter className="justify-center pb-6 pt-2">
                 {product.price && (
                   <p class="text-lg font-medium text-[hsl(var(--primary))]">R$ {product.price.toFixed(2).replace('.', ',')}</p>
                )}
              </CardFooter>
            </Card>
            ))}
         </div>
       </div>
    </main>

    <Footer />
  </div>
</Layout>
